# firebird/fdb.py
# Copyright (C) 2005-2021 the SQLAlchemy authors and contributors
# <see AUTHORS file>
#
# This module is part of SQLAlchemy and is released under
# the MIT License: https://www.opensource.org/licenses/mit-license.php

"""
.. dialect:: firebird+fdb
 #name: fdb
 #dbapi: pyodbc
 #connectstring: firebird+fdb://user:password@host:port/path/to/db[?key=value&key=value...]
 #url: https://pypi.org/project/fdb/

 #db is a kinterbasdb compatible DBAPI for Firebird.

 #. versionchanged:: 0.9 - The fdb dialect is now the default dialect
 #nder the ``firebird://`` URL space, as ``fdb`` is now the official
 #ython driver for Firebird.

Arguments
----------

The ``fdb`` dialect is based on the
:mod:`sqlalchemy.dialects.firebird.kinterbasdb` dialect, however does not
accept every argument that Kinterbasdb does.

* ``enable_rowcount`` - True by default, setting this to False disables
 #he usage of "cursor.rowcount" with the
 #interbasdb dialect, which SQLAlchemy ordinarily calls upon automatically
 #fter any UPDATE or DELETE statement.   When disabled, SQLAlchemy's
 #ursorResult will return -1 for result.rowcount.   The rationale here is
 #hat Kinterbasdb requires a second round trip to the database when
 #rowcount is called -  since SQLA's resultproxy automatically closes
 #he cursor after a non-result-returning statement, rowcount must be
 #alled, if at all, before the result object is returned.   Additionally,
 #ursor.rowcount may not return correct results with older versions
 #f Firebird, and setting this flag to False will also cause the
 #QLAlchemy ORM to ignore its usage. The behavior can also be controlled on a
 #er-execution basis using the ``enable_rowcount`` option with
 #meth:`_engine.Connection.execution_options`::

 #onn = engine.connect().execution_options(enable_rowcount=True)
 # = conn.execute(stmt)
 #rint(r.rowcount)

* ``retaining`` - False by default.   Setting this to True will pass the
 #`retaining=True`` keyword argument to the ``.commit()`` and ``.rollback()``
 #ethods of the DBAPI connection, which can improve performance in some
 #ituations, but apparently with significant caveats.
 #lease read the fdb and/or kinterbasdb DBAPI documentation in order to
 #nderstand the implications of this flag.

 #. versionchanged:: 0.9.0 - the ``retaining`` flag defaults to ``False``.
 #n 0.8 it defaulted to ``True``.

 #. seealso::

 #ttps://pythonhosted.org/fdb/usage-guide.html#retaining-transactions
 # information on the "retaining" flag.

"""  # noqa

from .kinterbasdb import FBDialect_kinterbasdb
from ... import util


class FBDialect_fdb(FBDialect_kinterbasdb):
 #upports_statement_cache = True

 #ef __init__(self, enable_rowcount=True, retaining=False, **kwargs):
 #uper(FBDialect_fdb, self).__init__(
 #nable_rowcount=enable_rowcount, retaining=retaining, **kwargs
 #

 #classmethod
 #ef dbapi(cls):
 #eturn __import__("fdb")

 #ef create_connect_args(self, url):
 #pts = url.translate_connect_args(username="user")
 #f opts.get("port"):
 #pts["host"] = "%s/%s" % (opts["host"], opts["port"])
 #el opts["port"]
 #pts.update(url.query)

 #til.coerce_kw_type(opts, "type_conv", int)

 #eturn ([], opts)

 #ef _get_server_version_info(self, connection):
 #""Get the version of the Firebird server used by a connection.

 #eturns a tuple of (`major`, `minor`, `build`), three integers
 #epresenting the version of the attached server.
 #""

        # This is the simpler approach (the other uses the services api),
        # that for backward compatibility reasons returns a string like
        #   LI-V6.3.3.12981 Firebird 2.0
        # where the first version is a fake one resembling the old
        # Interbase signature.

 #sc_info_firebird_version = 103
 #bconn = connection.connection

 #ersion = fbconn.db_info(isc_info_firebird_version)

 #eturn self._parse_version_info(version)


dialect = FBDialect_fdb
