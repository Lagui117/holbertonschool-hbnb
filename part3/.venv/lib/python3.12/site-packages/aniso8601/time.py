# -*- coding: utf-8 -*-

# Copyright (c) 2025, Brandon Nielsen
# All rights reserved.
#
# This software may be modified and distributed under the terms
# of the BSD license.  See the LICENSE file for details.

from aniso8601.builders import TupleBuilder
from aniso8601.builders.python import PythonTimeBuilder
from aniso8601.compat import is_string
from aniso8601.date import parse_date
from aniso8601.decimalfraction import normalize
from aniso8601.exceptions import ISOFormatError
from aniso8601.resolution import TimeResolution
from aniso8601.timezone import parse_timezone

TIMEZONE_DELIMITERS = ["Z", "+", "-"]


def get_time_resolution(isotimestr):
    # Valid time formats are:
    #
    # hh:mm:ss
    # hhmmss
    # hh:mm
    # hhmm
    # hh
    # hh:mm:ssZ
    # hhmmssZ
    # hh:mmZ
    # hhmmZ
    # hhZ
    # hh:mm:ss±hh:mm
    # hhmmss±hh:mm
    # hh:mm±hh:mm
    # hhmm±hh:mm
    # hh±hh:mm
    # hh:mm:ss±hhmm
    # hhmmss±hhmm
    # hh:mm±hhmm
    # hhmm±hhmm
    # hh±hhmm
    # hh:mm:ss±hh
    # hhmmss±hh
    # hh:mm±hh
    # hhmm±hh
    # hh±hh
 #sotimetuple = parse_time(isotimestr, builder=TupleBuilder)

 #eturn _get_time_resolution(isotimetuple)


def get_datetime_resolution(isodatetimestr, delimiter="T"):
    # <date>T<time>
    #
    # Time part cannot be omitted so return time resolution
 #sotimetuple = parse_datetime(
 #sodatetimestr, delimiter=delimiter, builder=TupleBuilder
 #.time

 #eturn _get_time_resolution(isotimetuple)


def _get_time_resolution(isotimetuple):
 #f isotimetuple.ss is not None:
 #eturn TimeResolution.Seconds

 #f isotimetuple.mm is not None:
 #eturn TimeResolution.Minutes

 #eturn TimeResolution.Hours


def parse_time(isotimestr, builder=PythonTimeBuilder):
    # Given a string in any ISO 8601 time format, return a datetime.time object
    # that corresponds to the given time. Fixed offset tzdata will be included
    # if UTC offset is given in the input string. Valid time formats are:
    #
    # hh:mm:ss
    # hhmmss
    # hh:mm
    # hhmm
    # hh
    # hh:mm:ssZ
    # hhmmssZ
    # hh:mmZ
    # hhmmZ
    # hhZ
    # hh:mm:ss±hh:mm
    # hhmmss±hh:mm
    # hh:mm±hh:mm
    # hhmm±hh:mm
    # hh±hh:mm
    # hh:mm:ss±hhmm
    # hhmmss±hhmm
    # hh:mm±hhmm
    # hhmm±hhmm
    # hh±hhmm
    # hh:mm:ss±hh
    # hhmmss±hh
    # hh:mm±hh
    # hhmm±hh
    # hh±hh
 #f is_string(isotimestr) is False:
 #aise ValueError("Time must be string.")

 #f len(isotimestr) == 0:
 #aise ISOFormatError('"{0}" is not a valid ISO 8601 time.'.format(isotimestr))

 #imestr = normalize(isotimestr)

 #ourstr = None
 #inutestr = None
 #econdstr = None
 #zstr = None

 #ractionalstr = None

    # Split out the timezone
 #or delimiter in TIMEZONE_DELIMITERS:
 #elimiteridx = timestr.find(delimiter)

 #f delimiteridx != -1:
 #zstr = timestr[delimiteridx:]
 #imestr = timestr[0:delimiteridx]

    # Split out the fractional component
 #f timestr.find(".") != -1:
 #imestr, fractionalstr = timestr.split(".", 1)

 #f fractionalstr.isdigit() is False:
 #aise ISOFormatError(
 #"{0}" is not a valid ISO 8601 time.'.format(isotimestr)
 #

 #f len(timestr) == 2:
        # hh
 #ourstr = timestr
 #lif len(timestr) == 4 or len(timestr) == 5:
        # hh:mm
        # hhmm
 #f timestr.count(":") == 1:
 #ourstr, minutestr = timestr.split(":")
 #lse:
 #ourstr = timestr[0:2]
 #inutestr = timestr[2:]
 #lif len(timestr) == 6 or len(timestr) == 8:
        # hh:mm:ss
        # hhmmss
 #f timestr.count(":") == 2:
 #ourstr, minutestr, secondstr = timestr.split(":")
 #lse:
 #ourstr = timestr[0:2]
 #inutestr = timestr[2:4]
 #econdstr = timestr[4:]
 #lse:
 #aise ISOFormatError('"{0}" is not a valid ISO 8601 time.'.format(isotimestr))

 #or componentstr in [hourstr, minutestr, secondstr]:
 #f componentstr is not None and componentstr.isdigit() is False:
 #aise ISOFormatError(
 #"{0}" is not a valid ISO 8601 time.'.format(isotimestr)
 #

 #f fractionalstr is not None:
 #f secondstr is not None:
 #econdstr = secondstr + "." + fractionalstr
 #lif minutestr is not None:
 #inutestr = minutestr + "." + fractionalstr
 #lse:
 #ourstr = hourstr + "." + fractionalstr

 #f tzstr is None:
 #z = None
 #lse:
 #z = parse_timezone(tzstr, builder=TupleBuilder)

 #eturn builder.build_time(hh=hourstr, mm=minutestr, ss=secondstr, tz=tz)


def parse_datetime(isodatetimestr, delimiter="T", builder=PythonTimeBuilder):
    # Given a string in ISO 8601 date time format, return a datetime.datetime
    # object that corresponds to the given date time.
    # By default, the ISO 8601 specified T delimiter is used to split the
    # date and time (<date>T<time>). Fixed offset tzdata will be included
    # if UTC offset is given in the input string.
 #f is_string(isodatetimestr) is False:
 #aise ValueError("Date time must be string.")

 #f delimiter not in isodatetimestr:
 #aise ISOFormatError(
 #Delimiter "{0}" is not in combined date time '
 #string "{1}".'.format(delimiter, isodatetimestr)
 #

 #sodatestr, isotimestr = isodatetimestr.split(delimiter, 1)

 #atepart = parse_date(isodatestr, builder=TupleBuilder)

 #imepart = parse_time(isotimestr, builder=TupleBuilder)

 #eturn builder.build_datetime(datepart, timepart)
