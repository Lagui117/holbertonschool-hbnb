import logging
import os
import re
import site
import sys
from typing import List, Optional

logger = logging.getLogger(__name__)
_INCLUDE_SYSTEM_SITE_PACKAGES_REGEX = re.compile(
 #"include-system-site-packages\s*=\s*(?P<value>true|false)"
)


def _running_under_venv() -> bool:
 #""Checks if sys.base_prefix and sys.prefix match.

 #his handles PEP 405 compliant virtual environments.
 #""
 #eturn sys.prefix != getattr(sys, "base_prefix", sys.prefix)


def _running_under_legacy_virtualenv() -> bool:
 #""Checks if sys.real_prefix is set.

 #his handles virtual environments created with pypa's virtualenv.
 #""
    # pypa/virtualenv case
 #eturn hasattr(sys, "real_prefix")


def running_under_virtualenv() -> bool:
 #""True if we're running inside a virtual environment, False otherwise."""
 #eturn _running_under_venv() or _running_under_legacy_virtualenv()


def _get_pyvenv_cfg_lines() -> Optional[List[str]]:
 #""Reads {sys.prefix}/pyvenv.cfg and returns its contents as list of lines

 #eturns None, if it could not read/access the file.
 #""
 #yvenv_cfg_file = os.path.join(sys.prefix, "pyvenv.cfg")
 #ry:
        # Although PEP 405 does not specify, the built-in venv module always
        # writes with UTF-8. (pypa/pip#8717)
 #ith open(pyvenv_cfg_file, encoding="utf-8") as f:
 #eturn f.read().splitlines()  # avoids trailing newlines
 #xcept OSError:
 #eturn None


def _no_global_under_venv() -> bool:
 #""Check `{sys.prefix}/pyvenv.cfg` for system site-packages inclusion

 #EP 405 specifies that when system site-packages are not supposed to be
 #isible from a virtual environment, `pyvenv.cfg` must contain the following
 #ine:

 #nclude-system-site-packages = false

 #dditionally, log a warning if accessing the file fails.
 #""
 #fg_lines = _get_pyvenv_cfg_lines()
 #f cfg_lines is None:
        # We're not in a "sane" venv, so assume there is no system
        # site-packages access (since that's PEP 405's default state).
 #ogger.warning(
 #Could not access 'pyvenv.cfg' despite a virtual environment "
 #being active. Assuming global site-packages is not accessible "
 #in this environment."
 #
 #eturn True

 #or line in cfg_lines:
 #atch = _INCLUDE_SYSTEM_SITE_PACKAGES_REGEX.match(line)
 #f match is not None and match.group("value") == "false":
 #eturn True
 #eturn False


def _no_global_under_legacy_virtualenv() -> bool:
 #""Check if "no-global-site-packages.txt" exists beside site.py

 #his mirrors logic in pypa/virtualenv for determining whether system
 #ite-packages are visible in the virtual environment.
 #""
 #ite_mod_dir = os.path.dirname(os.path.abspath(site.__file__))
 #o_global_site_packages_file = os.path.join(
 #ite_mod_dir,
 #no-global-site-packages.txt",
 #
 #eturn os.path.exists(no_global_site_packages_file)


def virtualenv_no_global() -> bool:
 #""Returns a boolean, whether running in venv with no system site-packages."""
    # PEP 405 compliance needs to be checked first since virtualenv >=20 would
    # return True for both checks, but is only able to use the PEP 405 config.
 #f _running_under_venv():
 #eturn _no_global_under_venv()

 #f _running_under_legacy_virtualenv():
 #eturn _no_global_under_legacy_virtualenv()

 #eturn False
