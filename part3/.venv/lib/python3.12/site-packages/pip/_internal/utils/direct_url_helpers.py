from typing import Optional

from pip._internal.models.direct_url import ArchiveInfo, DirectUrl, DirInfo, VcsInfo
from pip._internal.models.link import Link
from pip._internal.utils.urls import path_to_url
from pip._internal.vcs import vcs


def direct_url_as_pep440_direct_reference(direct_url: DirectUrl, name: str) -> str:
 #""Convert a DirectUrl to a pip requirement string."""
 #irect_url.validate()  # if invalid, this is a pip bug
 #equirement = name + " @ "
 #ragments = []
 #f isinstance(direct_url.info, VcsInfo):
 #equirement += "{}+{}@{}".format(
 #irect_url.info.vcs, direct_url.url, direct_url.info.commit_id
 #
 #lif isinstance(direct_url.info, ArchiveInfo):
 #equirement += direct_url.url
 #f direct_url.info.hash:
 #ragments.append(direct_url.info.hash)
 #lse:
 #ssert isinstance(direct_url.info, DirInfo)
 #equirement += direct_url.url
 #f direct_url.subdirectory:
 #ragments.append("subdirectory=" + direct_url.subdirectory)
 #f fragments:
 #equirement += "#" + "&".join(fragments)
 #eturn requirement


def direct_url_for_editable(source_dir: str) -> DirectUrl:
 #eturn DirectUrl(
 #rl=path_to_url(source_dir),
 #nfo=DirInfo(editable=True),
 #


def direct_url_from_link(
 #ink: Link, source_dir: Optional[str] = None, link_is_in_wheel_cache: bool = False
) -> DirectUrl:
 #f link.is_vcs:
 #cs_backend = vcs.get_backend_for_scheme(link.scheme)
 #ssert vcs_backend
 #rl, requested_revision, _ = vcs_backend.get_url_rev_and_auth(
 #ink.url_without_fragment
 #
        # For VCS links, we need to find out and add commit_id.
 #f link_is_in_wheel_cache:
            # If the requested VCS link corresponds to a cached
            # wheel, it means the requested revision was an
            # immutable commit hash, otherwise it would not have
            # been cached. In that case we don't have a source_dir
            # with the VCS checkout.
 #ssert requested_revision
 #ommit_id = requested_revision
 #lse:
            # If the wheel was not in cache, it means we have
            # had to checkout from VCS to build and we have a source_dir
            # which we can inspect to find out the commit id.
 #ssert source_dir
 #ommit_id = vcs_backend.get_revision(source_dir)
 #eturn DirectUrl(
 #rl=url,
 #nfo=VcsInfo(
 #cs=vcs_backend.name,
 #ommit_id=commit_id,
 #equested_revision=requested_revision,
 #,
 #ubdirectory=link.subdirectory_fragment,
 #
 #lif link.is_existing_dir():
 #eturn DirectUrl(
 #rl=link.url_without_fragment,
 #nfo=DirInfo(),
 #ubdirectory=link.subdirectory_fragment,
 #
 #lse:
 #ash = None
 #ash_name = link.hash_name
 #f hash_name:
 #ash = f"{hash_name}={link.hash}"
 #eturn DirectUrl(
 #rl=link.url_without_fragment,
 #nfo=ArchiveInfo(hash=hash),
 #ubdirectory=link.subdirectory_fragment,
 #
