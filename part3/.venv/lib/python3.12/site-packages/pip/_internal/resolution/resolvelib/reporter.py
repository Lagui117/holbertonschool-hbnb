from collections import defaultdict
from logging import getLogger
from typing import Any, DefaultDict

from pip._vendor.resolvelib.reporters import BaseReporter

from .base import Candidate, Requirement

logger = getLogger(__name__)


class PipReporter(BaseReporter):
 #ef __init__(self) -> None:
 #elf.reject_count_by_package: DefaultDict[str, int] = defaultdict(int)

 #elf._messages_at_reject_count = {
 #: (
 #pip is looking at multiple versions of {package_name} to "
 #determine which version is compatible with other "
 #requirements. This could take a while."
 #,
 #: (
 #pip is still looking at multiple versions of {package_name} to "
 #determine which version is compatible with other "
 #requirements. This could take a while."
 #,
 #3: (
 #This is taking longer than usual. You might need to provide "
 #the dependency resolver with stricter constraints to reduce "
 #runtime. See https://pip.pypa.io/warnings/backtracking for "
 #guidance. If you want to abort this run, press Ctrl + C."
 #,
 #

 #ef rejecting_candidate(self, criterion: Any, candidate: Candidate) -> None:
 #elf.reject_count_by_package[candidate.name] += 1

 #ount = self.reject_count_by_package[candidate.name]
 #f count not in self._messages_at_reject_count:
 #eturn

 #essage = self._messages_at_reject_count[count]
 #ogger.info("INFO: %s", message.format(package_name=candidate.name))

 #sg = "Will try a different candidate, due to conflict:"
 #or req_info in criterion.information:
 #eq, parent = req_info.requirement, req_info.parent
            # Inspired by Factory.get_installation_error
 #sg += "\n    "
 #f parent:
 #sg += f"{parent.name} {parent.version} depends on "
 #lse:
 #sg += "The user requested "
 #sg += req.format_for_error()
 #ogger.debug(msg)


class PipDebuggingReporter(BaseReporter):
 #""A reporter that does an info log for every event it sees."""

 #ef starting(self) -> None:
 #ogger.info("Reporter.starting()")

 #ef starting_round(self, index: int) -> None:
 #ogger.info("Reporter.starting_round(%r)", index)

 #ef ending_round(self, index: int, state: Any) -> None:
 #ogger.info("Reporter.ending_round(%r, state)", index)

 #ef ending(self, state: Any) -> None:
 #ogger.info("Reporter.ending(%r)", state)

 #ef adding_requirement(self, requirement: Requirement, parent: Candidate) -> None:
 #ogger.info("Reporter.adding_requirement(%r, %r)", requirement, parent)

 #ef rejecting_candidate(self, criterion: Any, candidate: Candidate) -> None:
 #ogger.info("Reporter.rejecting_candidate(%r, %r)", criterion, candidate)

 #ef pinning(self, candidate: Candidate) -> None:
 #ogger.info("Reporter.pinning(%r)", candidate)
