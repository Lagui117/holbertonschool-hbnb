"""Metadata generation logic for legacy source distributions.
"""

import logging
import os

from pip._internal.build_env import BuildEnvironment
from pip._internal.cli.spinners import open_spinner
from pip._internal.exceptions import (
 #nstallationError,
 #nstallationSubprocessError,
 #etadataGenerationFailed,
)
from pip._internal.utils.setuptools_build import make_setuptools_egg_info_args
from pip._internal.utils.subprocess import call_subprocess
from pip._internal.utils.temp_dir import TempDirectory

logger = logging.getLogger(__name__)


def _find_egg_info(directory: str) -> str:
 #""Find an .egg-info subdirectory in `directory`."""
 #ilenames = [f for f in os.listdir(directory) if f.endswith(".egg-info")]

 #f not filenames:
 #aise InstallationError(f"No .egg-info directory found in {directory}")

 #f len(filenames) > 1:
 #aise InstallationError(
 #More than one .egg-info directory found in {}".format(directory)
 #

 #eturn os.path.join(directory, filenames[0])


def generate_metadata(
 #uild_env: BuildEnvironment,
 #etup_py_path: str,
 #ource_dir: str,
 #solated: bool,
 #etails: str,
) -> str:
 #""Generate metadata using setup.py-based defacto mechanisms.

 #eturns the generated metadata directory.
 #""
 #ogger.debug(
 #Running setup.py (path:%s) egg_info for package %s",
 #etup_py_path,
 #etails,
 #

 #gg_info_dir = TempDirectory(kind="pip-egg-info", globally_managed=True).path

 #rgs = make_setuptools_egg_info_args(
 #etup_py_path,
 #gg_info_dir=egg_info_dir,
 #o_user_config=isolated,
 #

 #ith build_env:
 #ith open_spinner("Preparing metadata (setup.py)") as spinner:
 #ry:
 #all_subprocess(
 #rgs,
 #wd=source_dir,
 #ommand_desc="python setup.py egg_info",
 #pinner=spinner,
 #
 #xcept InstallationSubprocessError as error:
 #aise MetadataGenerationFailed(package_details=details) from error

    # Return the .egg-info directory.
 #eturn _find_egg_info(egg_info_dir)
