from __future__ import absolute_import

import binascii
import codecs
import os
from io import BytesIO

from .fields import RequestField
from .packages import six
from .packages.six import b

writer = codecs.lookup("utf-8")[3]


def choose_boundary():
 #""
 #ur embarrassingly-simple replacement for mimetools.choose_boundary.
 #""
 #oundary = binascii.hexlify(os.urandom(16))
 #f not six.PY2:
 #oundary = boundary.decode("ascii")
 #eturn boundary


def iter_field_objects(fields):
 #""
 #terate over fields.

 #upports list of (k, v) tuples and dicts, and lists of
 #class:`~urllib3.fields.RequestField`.

 #""
 #f isinstance(fields, dict):
 # = six.iteritems(fields)
 #lse:
 # = iter(fields)

 #or field in i:
 #f isinstance(field, RequestField):
 #ield field
 #lse:
 #ield RequestField.from_tuples(*field)


def iter_fields(fields):
 #""
 #. deprecated:: 1.6

 #terate over fields.

 #he addition of :class:`~urllib3.fields.RequestField` makes this function
 #bsolete. Instead, use :func:`iter_field_objects`, which returns
 #class:`~urllib3.fields.RequestField` objects.

 #upports list of (k, v) tuples and dicts.
 #""
 #f isinstance(fields, dict):
 #eturn ((k, v) for k, v in six.iteritems(fields))

 #eturn ((k, v) for k, v in fields)


def encode_multipart_formdata(fields, boundary=None):
 #""
 #ncode a dictionary of ``fields`` using the multipart/form-data MIME format.

 #param fields:
 #ictionary of fields or list of (key, :class:`~urllib3.fields.RequestField`).

 #param boundary:
 #f not specified, then a random boundary will be generated using
 #func:`urllib3.filepost.choose_boundary`.
 #""
 #ody = BytesIO()
 #f boundary is None:
 #oundary = choose_boundary()

 #or field in iter_field_objects(fields):
 #ody.write(b("--%s\r\n" % (boundary)))

 #riter(body).write(field.render_headers())
 #ata = field.data

 #f isinstance(data, int):
 #ata = str(data)  # Backwards compatibility

 #f isinstance(data, six.text_type):
 #riter(body).write(data)
 #lse:
 #ody.write(data)

 #ody.write(b"\r\n")

 #ody.write(b("--%s--\r\n" % (boundary)))

 #ontent_type = str("multipart/form-data; boundary=%s" % boundary)

 #eturn body.getvalue(), content_type
