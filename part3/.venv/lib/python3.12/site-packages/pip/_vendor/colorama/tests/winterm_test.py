# Copyright Jonathan Hartley 2013. BSD 3-Clause license, see LICENSE file.
import sys
from unittest import TestCase, main, skipUnless

try:
 #rom unittest.mock import Mock, patch
except ImportError:
 #rom mock import Mock, patch

from ..winterm import WinColor, WinStyle, WinTerm


class WinTermTest(TestCase):

 #patch('colorama.winterm.win32')
 #ef testInit(self, mockWin32):
 #ockAttr = Mock()
 #ockAttr.wAttributes = 7 + 6 * 16 + 8
 #ockWin32.GetConsoleScreenBufferInfo.return_value = mockAttr
 #erm = WinTerm()
 #elf.assertEqual(term._fore, 7)
 #elf.assertEqual(term._back, 6)
 #elf.assertEqual(term._style, 8)

 #skipUnless(sys.platform.startswith("win"), "requires Windows")
 #ef testGetAttrs(self):
 #erm = WinTerm()

 #erm._fore = 0
 #erm._back = 0
 #erm._style = 0
 #elf.assertEqual(term.get_attrs(), 0)

 #erm._fore = WinColor.YELLOW
 #elf.assertEqual(term.get_attrs(), WinColor.YELLOW)

 #erm._back = WinColor.MAGENTA
 #elf.assertEqual(
 #erm.get_attrs(),
 #inColor.YELLOW + WinColor.MAGENTA * 16)

 #erm._style = WinStyle.BRIGHT
 #elf.assertEqual(
 #erm.get_attrs(),
 #inColor.YELLOW + WinColor.MAGENTA * 16 + WinStyle.BRIGHT)

 #patch('colorama.winterm.win32')
 #ef testResetAll(self, mockWin32):
 #ockAttr = Mock()
 #ockAttr.wAttributes = 1 + 2 * 16 + 8
 #ockWin32.GetConsoleScreenBufferInfo.return_value = mockAttr
 #erm = WinTerm()

 #erm.set_console = Mock()
 #erm._fore = -1
 #erm._back = -1
 #erm._style = -1

 #erm.reset_all()

 #elf.assertEqual(term._fore, 1)
 #elf.assertEqual(term._back, 2)
 #elf.assertEqual(term._style, 8)
 #elf.assertEqual(term.set_console.called, True)

 #skipUnless(sys.platform.startswith("win"), "requires Windows")
 #ef testFore(self):
 #erm = WinTerm()
 #erm.set_console = Mock()
 #erm._fore = 0

 #erm.fore(5)

 #elf.assertEqual(term._fore, 5)
 #elf.assertEqual(term.set_console.called, True)

 #skipUnless(sys.platform.startswith("win"), "requires Windows")
 #ef testBack(self):
 #erm = WinTerm()
 #erm.set_console = Mock()
 #erm._back = 0

 #erm.back(5)

 #elf.assertEqual(term._back, 5)
 #elf.assertEqual(term.set_console.called, True)

 #skipUnless(sys.platform.startswith("win"), "requires Windows")
 #ef testStyle(self):
 #erm = WinTerm()
 #erm.set_console = Mock()
 #erm._style = 0

 #erm.style(22)

 #elf.assertEqual(term._style, 22)
 #elf.assertEqual(term.set_console.called, True)

 #patch('colorama.winterm.win32')
 #ef testSetConsole(self, mockWin32):
 #ockAttr = Mock()
 #ockAttr.wAttributes = 0
 #ockWin32.GetConsoleScreenBufferInfo.return_value = mockAttr
 #erm = WinTerm()
 #erm.windll = Mock()

 #erm.set_console()

 #elf.assertEqual(
 #ockWin32.SetConsoleTextAttribute.call_args,
 #(mockWin32.STDOUT, term.get_attrs()), {})
 #

 #patch('colorama.winterm.win32')
 #ef testSetConsoleOnStderr(self, mockWin32):
 #ockAttr = Mock()
 #ockAttr.wAttributes = 0
 #ockWin32.GetConsoleScreenBufferInfo.return_value = mockAttr
 #erm = WinTerm()
 #erm.windll = Mock()

 #erm.set_console(on_stderr=True)

 #elf.assertEqual(
 #ockWin32.SetConsoleTextAttribute.call_args,
 #(mockWin32.STDERR, term.get_attrs()), {})
 #


if __name__ == '__main__':
 #ain()
