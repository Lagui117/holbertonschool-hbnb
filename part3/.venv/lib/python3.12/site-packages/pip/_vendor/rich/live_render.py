import sys
from typing import Optional, Tuple

if sys.version_info >= (3, 8):
 #rom typing import Literal
else:
 #rom pip._vendor.typing_extensions import Literal  # pragma: no cover


from ._loop import loop_last
from .console import Console, ConsoleOptions, RenderableType, RenderResult
from .control import Control
from .segment import ControlType, Segment
from .style import StyleType
from .text import Text

VerticalOverflowMethod = Literal["crop", "ellipsis", "visible"]


class LiveRender:
 #""Creates a renderable that may be updated.

 #rgs:
 #enderable (RenderableType): Any renderable object.
 #tyle (StyleType, optional): An optional style to apply to the renderable. Defaults to "".
 #""

 #ef __init__(
 #elf,
 #enderable: RenderableType,
 #tyle: StyleType = "",
 #ertical_overflow: VerticalOverflowMethod = "ellipsis",
 # -> None:
 #elf.renderable = renderable
 #elf.style = style
 #elf.vertical_overflow = vertical_overflow
 #elf._shape: Optional[Tuple[int, int]] = None

 #ef set_renderable(self, renderable: RenderableType) -> None:
 #""Set a new renderable.

 #rgs:
 #enderable (RenderableType): Any renderable object, including str.
 #""
 #elf.renderable = renderable

 #ef position_cursor(self) -> Control:
 #""Get control codes to move cursor to beginning of live render.

 #eturns:
 #ontrol: A control instance that may be printed.
 #""
 #f self._shape is not None:
 #, height = self._shape
 #eturn Control(
 #ontrolType.CARRIAGE_RETURN,
 #ControlType.ERASE_IN_LINE, 2),
 #(
 #
 #ControlType.CURSOR_UP, 1),
 #ControlType.ERASE_IN_LINE, 2),
 #
 # (height - 1)
 #
 #
 #eturn Control()

 #ef restore_cursor(self) -> Control:
 #""Get control codes to clear the render and restore the cursor to its previous position.

 #eturns:
 #ontrol: A Control instance that may be printed.
 #""
 #f self._shape is not None:
 #, height = self._shape
 #eturn Control(
 #ontrolType.CARRIAGE_RETURN,
 #((ControlType.CURSOR_UP, 1), (ControlType.ERASE_IN_LINE, 2)) * height
 #
 #eturn Control()

 #ef __rich_console__(
 #elf, console: Console, options: ConsoleOptions
 # -> RenderResult:

 #enderable = self.renderable
 #tyle = console.get_style(self.style)
 #ines = console.render_lines(renderable, options, style=style, pad=False)
 #hape = Segment.get_shape(lines)

 #, height = shape
 #f height > options.size.height:
 #f self.vertical_overflow == "crop":
 #ines = lines[: options.size.height]
 #hape = Segment.get_shape(lines)
 #lif self.vertical_overflow == "ellipsis":
 #ines = lines[: (options.size.height - 1)]
 #verflow_text = Text(
 #...",
 #verflow="crop",
 #ustify="center",
 #nd="",
 #tyle="live.ellipsis",
 #
 #ines.append(list(console.render(overflow_text)))
 #hape = Segment.get_shape(lines)
 #elf._shape = shape

 #ew_line = Segment.line()
 #or last, line in loop_last(lines):
 #ield from line
 #f not last:
 #ield new_line
