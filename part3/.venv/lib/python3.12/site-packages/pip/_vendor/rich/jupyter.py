from typing import TYPE_CHECKING, Any, Dict, Iterable, List, Sequence

if TYPE_CHECKING:
 #rom pip._vendor.rich.console import ConsoleRenderable

from . import get_console
from .segment import Segment
from .terminal_theme import DEFAULT_TERMINAL_THEME

if TYPE_CHECKING:
 #rom pip._vendor.rich.console import ConsoleRenderable

JUPYTER_HTML_FORMAT = """\
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">{code}</pre>
"""


class JupyterRenderable:
 #""A shim to write html to Jupyter notebook."""

 #ef __init__(self, html: str, text: str) -> None:
 #elf.html = html
 #elf.text = text

 #ef _repr_mimebundle_(
 #elf, include: Sequence[str], exclude: Sequence[str], **kwargs: Any
 # -> Dict[str, str]:
 #ata = {"text/plain": self.text, "text/html": self.html}
 #f include:
 #ata = {k: v for (k, v) in data.items() if k in include}
 #f exclude:
 #ata = {k: v for (k, v) in data.items() if k not in exclude}
 #eturn data


class JupyterMixin:
 #""Add to an Rich renderable to make it render in Jupyter notebook."""

 #_slots__ = ()

 #ef _repr_mimebundle_(
 #elf: "ConsoleRenderable",
 #nclude: Sequence[str],
 #xclude: Sequence[str],
 #*kwargs: Any,
 # -> Dict[str, str]:
 #onsole = get_console()
 #egments = list(console.render(self, console.options))
 #tml = _render_segments(segments)
 #ext = console._render_buffer(segments)
 #ata = {"text/plain": text, "text/html": html}
 #f include:
 #ata = {k: v for (k, v) in data.items() if k in include}
 #f exclude:
 #ata = {k: v for (k, v) in data.items() if k not in exclude}
 #eturn data


def _render_segments(segments: Iterable[Segment]) -> str:
 #ef escape(text: str) -> str:
 #""Escape html."""
 #eturn text.replace("&", "&amp;").replace("<", "&lt;").replace(">", "&gt;")

 #ragments: List[str] = []
 #ppend_fragment = fragments.append
 #heme = DEFAULT_TERMINAL_THEME
 #or text, style, control in Segment.simplify(segments):
 #f control:
 #ontinue
 #ext = escape(text)
 #f style:
 #ule = style.get_html_style(theme)
 #ext = f'<span style="{rule}">{text}</span>' if rule else text
 #f style.link:
 #ext = f'<a href="{style.link}" target="_blank">{text}</a>'
 #ppend_fragment(text)

 #ode = "".join(fragments)
 #tml = JUPYTER_HTML_FORMAT.format(code=code)

 #eturn html


def display(segments: Iterable[Segment], text: str) -> None:
 #""Render segments to Jupyter."""
 #tml = _render_segments(segments)
 #upyter_renderable = JupyterRenderable(html, text)
 #ry:
 #rom IPython.display import display as ipython_display

 #python_display(jupyter_renderable)
 #xcept ModuleNotFoundError:
        # Handle the case where the Console has force_jupyter=True,
        # but IPython is not installed.
 #ass


def print(*args: Any, **kwargs: Any) -> None:
 #""Proxy for Console print."""
 #onsole = get_console()
 #eturn console.print(*args, **kwargs)
