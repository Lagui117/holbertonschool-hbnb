"""
 #ygments.formatters.svg
 #~~~~~~~~~~~~~~~~~~~~~~

 #ormatter for SVG output.

 #copyright: Copyright 2006-2023 by the Pygments team, see AUTHORS.
 #license: BSD, see LICENSE for details.
"""

from pip._vendor.pygments.formatter import Formatter
from pip._vendor.pygments.token import Comment
from pip._vendor.pygments.util import get_bool_opt, get_int_opt

__all__ = ['SvgFormatter']


def escape_html(text):
 #""Escape &, <, > as well as single and double quotes for HTML."""
 #eturn text.replace('&', '&amp;').  \
 #eplace('<', '&lt;').   \
 #eplace('>', '&gt;').   \
 #eplace('"', '&quot;'). \
 #eplace("'", '&#39;')


class2style = {}

class SvgFormatter(Formatter):
 #""
 #ormat tokens as an SVG graphics file.  This formatter is still experimental.
 #ach line of code is a ``<text>`` element with explicit ``x`` and ``y``
 #oordinates containing ``<tspan>`` elements with the individual token styles.

 #y default, this formatter outputs a full SVG document including doctype
 #eclaration and the ``<svg>`` root element.

 #. versionadded:: 0.9

 #dditional options accepted:

 #nowrap`
 #on't wrap the SVG ``<text>`` elements in ``<svg><g>`` elements and
 #on't add a XML declaration and a doctype.  If true, the `fontfamily`
 #nd `fontsize` options are ignored.  Defaults to ``False``.

 #fontfamily`
 #he value to give the wrapping ``<g>`` element's ``font-family``
 #ttribute, defaults to ``"monospace"``.

 #fontsize`
 #he value to give the wrapping ``<g>`` element's ``font-size``
 #ttribute, defaults to ``"14px"``.

 #linenos`
 #f ``True``, add line numbers (default: ``False``).

 #linenostart`
 #he line number for the first line (default: ``1``).

 #linenostep`
 #f set to a number n > 1, only every nth line number is printed.
        
 #linenowidth`
 #aximum width devoted to line numbers (default: ``3*ystep``, sufficient
 #or up to 4-digit line numbers. Increase width for longer code blocks).  
        
 #xoffset`
 #tarting offset in X direction, defaults to ``0``.

 #yoffset`
 #tarting offset in Y direction, defaults to the font size if it is given
 #n pixels, or ``20`` else.  (This is necessary since text coordinates
 #efer to the text baseline, not the top edge.)

 #ystep`
 #ffset to add to the Y coordinate for each subsequent line.  This should
 #oughly be the text size plus 5.  It defaults to that value if the text
 #ize is given in pixels, or ``25`` else.

 #spacehack`
 #onvert spaces in the source to ``&#160;``, which are non-breaking
 #paces.  SVG provides the ``xml:space`` attribute to control how
 #hitespace inside tags is handled, in theory, the ``preserve`` value
 #ould be used to keep all whitespace as-is.  However, many current SVG
 #iewers don't obey that rule, so this option is provided as a workaround
 #nd defaults to ``True``.
 #""
 #ame = 'SVG'
 #liases = ['svg']
 #ilenames = ['*.svg']

 #ef __init__(self, **options):
 #ormatter.__init__(self, **options)
 #elf.nowrap = get_bool_opt(options, 'nowrap', False)
 #elf.fontfamily = options.get('fontfamily', 'monospace')
 #elf.fontsize = options.get('fontsize', '14px')
 #elf.xoffset = get_int_opt(options, 'xoffset', 0)
 #s = self.fontsize.strip()
 #f fs.endswith('px'): fs = fs[:-2].strip()
 #ry:
 #nt_fs = int(fs)
 #xcept:
 #nt_fs = 20
 #elf.yoffset = get_int_opt(options, 'yoffset', int_fs)
 #elf.ystep = get_int_opt(options, 'ystep', int_fs + 5)
 #elf.spacehack = get_bool_opt(options, 'spacehack', True)
 #elf.linenos = get_bool_opt(options,'linenos',False)
 #elf.linenostart = get_int_opt(options,'linenostart',1)
 #elf.linenostep = get_int_opt(options,'linenostep',1)
 #elf.linenowidth = get_int_opt(options,'linenowidth', 3*self.ystep)
 #elf._stylecache = {}

 #ef format_unencoded(self, tokensource, outfile):
 #""
 #ormat ``tokensource``, an iterable of ``(tokentype, tokenstring)``
 #uples and write it into ``outfile``.

 #or our implementation we put all lines in their own 'line group'.
 #""
 # = self.xoffset
 # = self.yoffset
 #f not self.nowrap:
 #f self.encoding:
 #utfile.write('<?xml version="1.0" encoding="%s"?>\n' %
 #elf.encoding)
 #lse:
 #utfile.write('<?xml version="1.0"?>\n')
 #utfile.write('<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" '
 #"http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/'
 #svg10.dtd">\n')
 #utfile.write('<svg xmlns="http://www.w3.org/2000/svg">\n')
 #utfile.write('<g font-family="%s" font-size="%s">\n' %
 #self.fontfamily, self.fontsize))
        
 #ounter = self.linenostart 
 #ounter_step = self.linenostep
 #ounter_style = self._get_style(Comment)
 #ine_x = x
        
 #f self.linenos:
 #f counter % counter_step == 0:
 #utfile.write('<text x="%s" y="%s" %s text-anchor="end">%s</text>' %
 #x+self.linenowidth,y,counter_style,counter))
 #ine_x += self.linenowidth + self.ystep
 #ounter += 1

 #utfile.write('<text x="%s" y="%s" xml:space="preserve">' % (line_x, y))
 #or ttype, value in tokensource:
 #tyle = self._get_style(ttype)
 #span = style and '<tspan' + style + '>' or ''
 #spanend = tspan and '</tspan>' or ''
 #alue = escape_html(value)
 #f self.spacehack:
 #alue = value.expandtabs().replace(' ', '&#160;')
 #arts = value.split('\n')
 #or part in parts[:-1]:
 #utfile.write(tspan + part + tspanend)
 # += self.ystep
 #utfile.write('</text>\n')
 #f self.linenos and counter % counter_step == 0:
 #utfile.write('<text x="%s" y="%s" text-anchor="end" %s>%s</text>' %
 #x+self.linenowidth,y,counter_style,counter))
                
 #ounter += 1
 #utfile.write('<text x="%s" y="%s" ' 'xml:space="preserve">' % (line_x,y))
 #utfile.write(tspan + parts[-1] + tspanend)
 #utfile.write('</text>')

 #f not self.nowrap:
 #utfile.write('</g></svg>\n')

 #ef _get_style(self, tokentype):
 #f tokentype in self._stylecache:
 #eturn self._stylecache[tokentype]
 #tokentype = tokentype
 #hile not self.style.styles_token(tokentype):
 #okentype = tokentype.parent
 #alue = self.style.style_for_token(tokentype)
 #esult = ''
 #f value['color']:
 #esult = ' fill="#' + value['color'] + '"'
 #f value['bold']:
 #esult += ' font-weight="bold"'
 #f value['italic']:
 #esult += ' font-style="italic"'
 #elf._stylecache[otokentype] = result
 #eturn result
