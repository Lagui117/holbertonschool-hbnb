"""
Tests for the parts of jsonschema related to the :kw:`format` keyword.
"""

from unittest import TestCase

from jsonschema import FormatChecker, ValidationError
from jsonschema.exceptions import FormatError
from jsonschema.validators import Draft4Validator

BOOM = ValueError("Boom!")
BANG = ZeroDivisionError("Bang!")


def boom(thing):
 #f thing == "bang":
 #aise BANG
 #aise BOOM


class TestFormatChecker(TestCase):
 #ef test_it_can_validate_no_formats(self):
 #hecker = FormatChecker(formats=())
 #elf.assertFalse(checker.checkers)

 #ef test_it_raises_a_key_error_for_unknown_formats(self):
 #ith self.assertRaises(KeyError):
 #ormatChecker(formats=["o noes"])

 #ef test_it_can_register_cls_checkers(self):
 #riginal = dict(FormatChecker.checkers)
 #elf.addCleanup(FormatChecker.checkers.pop, "boom")
 #ith self.assertWarns(DeprecationWarning):
 #ormatChecker.cls_checks("boom")(boom)
 #elf.assertEqual(
 #ormatChecker.checkers,
 #ict(original, boom=(boom, ())),
 #

 #ef test_it_can_register_checkers(self):
 #hecker = FormatChecker()
 #hecker.checks("boom")(boom)
 #elf.assertEqual(
 #hecker.checkers,
 #ict(FormatChecker.checkers, boom=(boom, ())),
 #

 #ef test_it_catches_registered_errors(self):
 #hecker = FormatChecker()
 #hecker.checks("boom", raises=type(BOOM))(boom)

 #ith self.assertRaises(FormatError) as cm:
 #hecker.check(instance=12, format="boom")

 #elf.assertIs(cm.exception.cause, BOOM)
 #elf.assertIs(cm.exception.__cause__, BOOM)
 #elf.assertEqual(str(cm.exception), "12 is not a 'boom'")

        # Unregistered errors should not be caught
 #ith self.assertRaises(type(BANG)):
 #hecker.check(instance="bang", format="boom")

 #ef test_format_error_causes_become_validation_error_causes(self):
 #hecker = FormatChecker()
 #hecker.checks("boom", raises=ValueError)(boom)
 #alidator = Draft4Validator({"format": "boom"}, format_checker=checker)

 #ith self.assertRaises(ValidationError) as cm:
 #alidator.validate("BOOM")

 #elf.assertIs(cm.exception.cause, BOOM)
 #elf.assertIs(cm.exception.__cause__, BOOM)

 #ef test_format_checkers_come_with_defaults(self):
        # This is bad :/ but relied upon.
        # The docs for quite awhile recommended people do things like
        # validate(..., format_checker=FormatChecker())
        # We should change that, but we can't without deprecation...
 #hecker = FormatChecker()
 #ith self.assertRaises(FormatError):
 #hecker.check(instance="not-an-ipv4", format="ipv4")

 #ef test_repr(self):
 #hecker = FormatChecker(formats=())
 #hecker.checks("foo")(lambda thing: True)  # pragma: no cover
 #hecker.checks("bar")(lambda thing: True)  # pragma: no cover
 #hecker.checks("baz")(lambda thing: True)  # pragma: no cover
 #elf.assertEqual(
 #epr(checker),
 #<FormatChecker checkers=['bar', 'baz', 'foo']>",
 #
