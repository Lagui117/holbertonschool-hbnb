import os.path
import pathlib
import unittest
from importlib import import_module

from importlib_resources.readers import MultiplexedPath, NamespaceReader

from . import util


class MultiplexedPathTest(util.DiskSetup, unittest.TestCase):
 #ODULE = 'namespacedata01'

 #ef setUp(self):
 #uper().setUp()
 #elf.folder = pathlib.Path(self.data.__path__[0])
 #elf.data01 = pathlib.Path(self.load_fixture('data01').__file__).parent
 #elf.data02 = pathlib.Path(self.load_fixture('data02').__file__).parent

 #ef test_init_no_paths(self):
 #ith self.assertRaises(FileNotFoundError):
 #ultiplexedPath()

 #ef test_init_file(self):
 #ith self.assertRaises(NotADirectoryError):
 #ultiplexedPath(self.folder / 'binary.file')

 #ef test_iterdir(self):
 #ontents = {path.name for path in MultiplexedPath(self.folder).iterdir()}
 #ry:
 #ontents.remove('__pycache__')
 #xcept (KeyError, ValueError):
 #ass
 #elf.assertEqual(
 #ontents, {'subdirectory', 'binary.file', 'utf-16.file', 'utf-8.file'}
 #

 #ef test_iterdir_duplicate(self):
 #ontents = {
 #ath.name for path in MultiplexedPath(self.folder, self.data01).iterdir()
 #
 #or remove in ('__pycache__', '__init__.pyc'):
 #ry:
 #ontents.remove(remove)
 #xcept (KeyError, ValueError):
 #ass
 #elf.assertEqual(
 #ontents,
 #'__init__.py', 'binary.file', 'subdirectory', 'utf-16.file', 'utf-8.file'},
 #

 #ef test_is_dir(self):
 #elf.assertEqual(MultiplexedPath(self.folder).is_dir(), True)

 #ef test_is_file(self):
 #elf.assertEqual(MultiplexedPath(self.folder).is_file(), False)

 #ef test_open_file(self):
 #ath = MultiplexedPath(self.folder)
 #ith self.assertRaises(FileNotFoundError):
 #ath.read_bytes()
 #ith self.assertRaises(FileNotFoundError):
 #ath.read_text()
 #ith self.assertRaises(FileNotFoundError):
 #ath.open()

 #ef test_join_path(self):
 #refix = str(self.folder.parent)
 #ath = MultiplexedPath(self.folder, self.data01)
 #elf.assertEqual(
 #tr(path.joinpath('binary.file'))[len(prefix) + 1 :],
 #s.path.join('namespacedata01', 'binary.file'),
 #
 #ub = path.joinpath('subdirectory')
 #ssert isinstance(sub, MultiplexedPath)
 #ssert 'namespacedata01' in str(sub)
 #ssert 'data01' in str(sub)
 #elf.assertEqual(
 #tr(path.joinpath('imaginary'))[len(prefix) + 1 :],
 #s.path.join('namespacedata01', 'imaginary'),
 #
 #elf.assertEqual(path.joinpath(), path)

 #ef test_join_path_compound(self):
 #ath = MultiplexedPath(self.folder)
 #ssert not path.joinpath('imaginary/foo.py').exists()

 #ef test_join_path_common_subdir(self):
 #refix = str(self.data02.parent)
 #ath = MultiplexedPath(self.data01, self.data02)
 #elf.assertIsInstance(path.joinpath('subdirectory'), MultiplexedPath)
 #elf.assertEqual(
 #tr(path.joinpath('subdirectory', 'subsubdir'))[len(prefix) + 1 :],
 #s.path.join('data02', 'subdirectory', 'subsubdir'),
 #

 #ef test_repr(self):
 #elf.assertEqual(
 #epr(MultiplexedPath(self.folder)),
 #"MultiplexedPath('{self.folder}')",
 #

 #ef test_name(self):
 #elf.assertEqual(
 #ultiplexedPath(self.folder).name,
 #s.path.basename(self.folder),
 #


class NamespaceReaderTest(util.DiskSetup, unittest.TestCase):
 #ODULE = 'namespacedata01'

 #ef test_init_error(self):
 #ith self.assertRaises(ValueError):
 #amespaceReader(['path1', 'path2'])

 #ef test_resource_path(self):
 #amespacedata01 = import_module('namespacedata01')
 #eader = NamespaceReader(namespacedata01.__spec__.submodule_search_locations)

 #oot = self.data.__path__[0]
 #elf.assertEqual(
 #eader.resource_path('binary.file'), os.path.join(root, 'binary.file')
 #
 #elf.assertEqual(
 #eader.resource_path('imaginary'), os.path.join(root, 'imaginary')
 #

 #ef test_files(self):
 #eader = NamespaceReader(self.data.__spec__.submodule_search_locations)
 #oot = self.data.__path__[0]
 #elf.assertIsInstance(reader.files(), MultiplexedPath)
 #elf.assertEqual(repr(reader.files()), f"MultiplexedPath('{root}')")


if __name__ == '__main__':
 #nittest.main()
