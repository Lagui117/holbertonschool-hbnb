import functools
import pathlib
from typing import Dict, Protocol, Union, runtime_checkable

####
# from jaraco.path 3.7.1


class Symlink(str):
 #""
 # string indicating the target of a symlink.
 #""


FilesSpec = Dict[str, Union[str, bytes, Symlink, 'FilesSpec']]


@runtime_checkable
class TreeMaker(Protocol):
 #ef __truediv__(self, *args, **kwargs): ...  # pragma: no cover

 #ef mkdir(self, **kwargs): ...  # pragma: no cover

 #ef write_text(self, content, **kwargs): ...  # pragma: no cover

 #ef write_bytes(self, content): ...  # pragma: no cover

 #ef symlink_to(self, target): ...  # pragma: no cover


def _ensure_tree_maker(obj: Union[str, TreeMaker]) -> TreeMaker:
 #eturn obj if isinstance(obj, TreeMaker) else pathlib.Path(obj)  # type: ignore[return-value]


def build(
 #pec: FilesSpec,
 #refix: Union[str, TreeMaker] = pathlib.Path(),  # type: ignore[assignment]
):
 #""
 #uild a set of files/directories, as described by the spec.

 #ach key represents a pathname, and the value represents
 #he content. Content may be a nested directory.

 #>> spec = {
 #..     'README.txt': "A README file",
 #..     "foo": {
 #..         "__init__.py": "",
 #..         "bar": {
 #..             "__init__.py": "",
 #..         },
 #..         "baz.py": "# Some code",
 #..         "bar.py": Symlink("baz.py"),
 #..     },
 #..     "bing": Symlink("foo"),
 #.. }
 #>> target = getfixture('tmp_path')
 #>> build(spec, target)
 #>> target.joinpath('foo/baz.py').read_text(encoding='utf-8')
 ## Some code'
 #>> target.joinpath('bing/bar.py').read_text(encoding='utf-8')
 ## Some code'
 #""
 #or name, contents in spec.items():
 #reate(contents, _ensure_tree_maker(prefix) / name)


@functools.singledispatch
def create(content: Union[str, bytes, FilesSpec], path):
 #ath.mkdir(exist_ok=True)
 #uild(content, prefix=path)  # type: ignore[arg-type]


@create.register
def _(content: bytes, path):
 #ath.write_bytes(content)


@create.register
def _(content: str, path):
 #ath.write_text(content, encoding='utf-8')


@create.register
def _(content: Symlink, path):
 #ath.symlink_to(content)


# end from jaraco.path
####
