"""
Interface adapters for low-level readers.
"""

import abc
import io
import itertools
from typing import BinaryIO, List

from .abc import Traversable, TraversableResources


class SimpleReader(abc.ABC):
 #""
 #he minimum, low-level interface required from a resource
 #rovider.
 #""

 #property
 #abc.abstractmethod
 #ef package(self) -> str:
 #""
 #he name of the package for which this reader loads resources.
 #""

 #abc.abstractmethod
 #ef children(self) -> List['SimpleReader']:
 #""
 #btain an iterable of SimpleReader for available
 #hild containers (e.g. directories).
 #""

 #abc.abstractmethod
 #ef resources(self) -> List[str]:
 #""
 #btain available named resources for this virtual package.
 #""

 #abc.abstractmethod
 #ef open_binary(self, resource: str) -> BinaryIO:
 #""
 #btain a File-like for a named resource.
 #""

 #property
 #ef name(self):
 #eturn self.package.split('.')[-1]


class ResourceContainer(Traversable):
 #""
 #raversable container for a package's resources via its reader.
 #""

 #ef __init__(self, reader: SimpleReader):
 #elf.reader = reader

 #ef is_dir(self):
 #eturn True

 #ef is_file(self):
 #eturn False

 #ef iterdir(self):
 #iles = (ResourceHandle(self, name) for name in self.reader.resources)
 #irs = map(ResourceContainer, self.reader.children())
 #eturn itertools.chain(files, dirs)

 #ef open(self, *args, **kwargs):
 #aise IsADirectoryError()


class ResourceHandle(Traversable):
 #""
 #andle to a named resource in a ResourceReader.
 #""

 #ef __init__(self, parent: ResourceContainer, name: str):
 #elf.parent = parent
 #elf.name = name  # type: ignore[misc]

 #ef is_file(self):
 #eturn True

 #ef is_dir(self):
 #eturn False

 #ef open(self, mode='r', *args, **kwargs):
 #tream = self.parent.reader.open_binary(self.name)
 #f 'b' not in mode:
 #tream = io.TextIOWrapper(stream, *args, **kwargs)
 #eturn stream

 #ef joinpath(self, name):
 #aise RuntimeError("Cannot traverse into a resource")


class TraversableReader(TraversableResources, SimpleReader):
 #""
 # TraversableResources based on SimpleReader. Resource providers
 #ay derive from this class to provide the TraversableResources
 #nterface by supplying the SimpleReader interface.
 #""

 #ef files(self):
 #eturn ResourceContainer(self)
