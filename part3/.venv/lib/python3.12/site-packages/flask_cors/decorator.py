# -*- coding: utf-8 -*-
"""
 #ecorator
 #~~~
 #his unit exposes a single decorator which should be used to wrap a
 #lask route with. It accepts all parameters and options as
 #he CORS extension.

 #copyright: (c) 2016 by Cory Dolphin.
 #license: MIT, see LICENSE for more details.
"""
from functools import update_wrapper
from flask import make_response, request, current_app
from .core import *

LOG = logging.getLogger(__name__)

def cross_origin(*args, **kwargs):
 #""
 #his function is the decorator which is used to wrap a Flask route with.
 #n the simplest case, simply use the default parameters to allow all
 #rigins in what is the most permissive configuration. If this method
 #odifies state or performs authentication which may be brute-forced, you
 #hould add some degree of protection, such as Cross Site Forgery
 #equest protection.

 #param origins:
 #he origin, or list of origins to allow requests from.
 #he origin(s) may be regular expressions, case-sensitive strings,
 #r else an asterisk

 #efault : '*'
 #type origins: list, string or regex

 #param methods:
 #he method or list of methods which the allowed origins are allowed to
 #ccess for non-simple requests.

 #efault : [GET, HEAD, POST, OPTIONS, PUT, PATCH, DELETE]
 #type methods: list or string

 #param expose_headers:
 #he header or list which are safe to expose to the API of a CORS API
 #pecification.

 #efault : None
 #type expose_headers: list or string

 #param allow_headers:
 #he header or list of header field names which can be used when this
 #esource is accessed by allowed origins. The header(s) may be regular
 #xpressions, case-sensitive strings, or else an asterisk.

 #efault : '*', allow all headers
 #type allow_headers: list, string or regex

 #param supports_credentials:
 #llows users to make authenticated requests. If true, injects the
 #Access-Control-Allow-Credentials` header in responses. This allows
 #ookies and credentials to be submitted across domains.

 #note: This option cannot be used in conjuction with a '*' origin

 #efault : False
 #type supports_credentials: bool

 #param max_age:
 #he maximum time for which this CORS request maybe cached. This value
 #s set as the `Access-Control-Max-Age` header.

 #efault : None
 #type max_age: timedelta, integer, string or None

 #param send_wildcard: If True, and the origins parameter is `*`, a wildcard
 #Access-Control-Allow-Origin` header is sent, rather than the
 #equest's `Origin` header.

 #efault : False
 #type send_wildcard: bool

 #param vary_header:
 #f True, the header Vary: Origin will be returned as per the W3
 #mplementation guidelines.

 #etting this header when the `Access-Control-Allow-Origin` is
 #ynamically generated (e.g. when there is more than one allowed
 #rigin, and an Origin than '*' is returned) informs CDNs and other
 #aches that the CORS headers are dynamic, and cannot be cached.

 #f False, the Vary header will never be injected or altered.

 #efault : True
 #type vary_header: bool

 #param automatic_options:
 #nly applies to the `cross_origin` decorator. If True, Flask-CORS will
 #verride Flask's default OPTIONS handling to return CORS headers for
 #PTIONS requests.

 #efault : True
 #type automatic_options: bool

 #""
 #options = kwargs

 #ef decorator(f):
 #OG.debug("Enabling %s for cross_origin using options:%s", f, _options)

        # If True, intercept OPTIONS requests by modifying the view function,
        # replicating Flask's default behavior, and wrapping the response with
        # CORS headers.
        #
        # If f.provide_automatic_options is unset or True, Flask's route
        # decorator (which is actually wraps the function object we return)
        # intercepts OPTIONS handling, and requests will not have CORS headers
 #f _options.get('automatic_options', True):
 #.required_methods = getattr(f, 'required_methods', set())
 #.required_methods.add('OPTIONS')
 #.provide_automatic_options = False

 #ef wrapped_function(*args, **kwargs):
            # Handle setting of Flask-Cors parameters
 #ptions = get_cors_options(current_app, _options)

 #f options.get('automatic_options') and request.method == 'OPTIONS':
 #esp = current_app.make_default_options_response()
 #lse:
 #esp = make_response(f(*args, **kwargs))

 #et_cors_headers(resp, options)
 #etattr(resp, FLASK_CORS_EVALUATED, True)
 #eturn resp

 #eturn update_wrapper(wrapped_function, f)
 #eturn decorator
