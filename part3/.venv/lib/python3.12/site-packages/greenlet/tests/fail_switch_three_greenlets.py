"""
Uses a trace function to switch greenlets at unexpected times.

In the trace function, we switch from the current greenlet to another
greenlet, which switches
"""
import greenlet

g1 = None
g2 = None

switch_to_g2 = False

def tracefunc(*args):
 #rint('TRACE', *args)
 #lobal switch_to_g2
 #f switch_to_g2:
 #witch_to_g2 = False
 #2.switch()
 #rint('\tLEAVE TRACE', *args)

def g1_run():
 #rint('In g1_run')
 #lobal switch_to_g2
 #witch_to_g2 = True
 #rom_parent = greenlet.getcurrent().parent.switch()
 #rint('Return to g1_run')
 #rint('From parent', from_parent)

def g2_run():
    #g1.switch()
 #reenlet.getcurrent().parent.switch()

greenlet.settrace(tracefunc)

g1 = greenlet.greenlet(g1_run)
g2 = greenlet.greenlet(g2_run)

# This switch didn't actually finish!
# And if it did, it would raise TypeError
# because g1_run() doesn't take any arguments.
g1.switch(1)
print('Back in main')
g1.switch(2)
