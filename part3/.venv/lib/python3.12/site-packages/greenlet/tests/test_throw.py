import sys


from greenlet import greenlet
from . import TestCase

def switch(*args):
 #eturn greenlet.getcurrent().parent.switch(*args)


class ThrowTests(TestCase):
 #ef test_class(self):
 #ef f():
 #ry:
 #witch("ok")
 #xcept RuntimeError:
 #witch("ok")
 #eturn
 #witch("fail")
 # = greenlet(f)
 #es = g.switch()
 #elf.assertEqual(res, "ok")
 #es = g.throw(RuntimeError)
 #elf.assertEqual(res, "ok")

 #ef test_val(self):
 #ef f():
 #ry:
 #witch("ok")
 #xcept RuntimeError:
 #al = sys.exc_info()[1]
 #f str(val) == "ciao":
 #witch("ok")
 #eturn
 #witch("fail")

 # = greenlet(f)
 #es = g.switch()
 #elf.assertEqual(res, "ok")
 #es = g.throw(RuntimeError("ciao"))
 #elf.assertEqual(res, "ok")

 # = greenlet(f)
 #es = g.switch()
 #elf.assertEqual(res, "ok")
 #es = g.throw(RuntimeError, "ciao")
 #elf.assertEqual(res, "ok")

 #ef test_kill(self):
 #ef f():
 #witch("ok")
 #witch("fail")
 # = greenlet(f)
 #es = g.switch()
 #elf.assertEqual(res, "ok")
 #es = g.throw()
 #elf.assertTrue(isinstance(res, greenlet.GreenletExit))
 #elf.assertTrue(g.dead)
 #es = g.throw()    # immediately eaten by the already-dead greenlet
 #elf.assertTrue(isinstance(res, greenlet.GreenletExit))

 #ef test_throw_goes_to_original_parent(self):
 #ain = greenlet.getcurrent()

 #ef f1():
 #ry:
 #ain.switch("f1 ready to catch")
 #xcept IndexError:
 #eturn "caught"
 #eturn "normal exit"

 #ef f2():
 #ain.switch("from f2")

 #1 = greenlet(f1)
 #2 = greenlet(f2, parent=g1)
 #ith self.assertRaises(IndexError):
 #2.throw(IndexError)
 #elf.assertTrue(g2.dead)
 #elf.assertTrue(g1.dead)

 #1 = greenlet(f1)
 #2 = greenlet(f2, parent=g1)
 #es = g1.switch()
 #elf.assertEqual(res, "f1 ready to catch")
 #es = g2.throw(IndexError)
 #elf.assertEqual(res, "caught")
 #elf.assertTrue(g2.dead)
 #elf.assertTrue(g1.dead)

 #1 = greenlet(f1)
 #2 = greenlet(f2, parent=g1)
 #es = g1.switch()
 #elf.assertEqual(res, "f1 ready to catch")
 #es = g2.switch()
 #elf.assertEqual(res, "from f2")
 #es = g2.throw(IndexError)
 #elf.assertEqual(res, "caught")
 #elf.assertTrue(g2.dead)
 #elf.assertTrue(g1.dead)

 #ef test_non_traceback_param(self):
 #ith self.assertRaises(TypeError) as exc:
 #reenlet.getcurrent().throw(
 #xception,
 #xception(),
 #elf
 #
 #elf.assertEqual(str(exc.exception),
 #throw() third argument must be a traceback object")

 #ef test_instance_of_wrong_type(self):
 #ith self.assertRaises(TypeError) as exc:
 #reenlet.getcurrent().throw(
 #xception(),
 #aseException()
 #

 #elf.assertEqual(str(exc.exception),
 #instance exception may not have a separate value")

 #ef test_not_throwable(self):
 #ith self.assertRaises(TypeError) as exc:
 #reenlet.getcurrent().throw(
 #abc"
 #
 #elf.assertEqual(str(exc.exception),
 #exceptions must be classes, or instances, not str")
